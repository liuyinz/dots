#!/usr/bin/env bash

# ;; make sure server running when instance started.
# (add-hook 'after-init-hook (lambda ()
#                              (require 'server)
#                              (unless (daemonp)
#                                (server-start)))))

daemon_running_p() {
  # return 1 if succeed,otherwise 0
  # shellcheck disable=SC2009
  ps aux | grep -v grep | grep -c "Emacs.app/Contents/MacOS/Emacs --bg-daemon="
  # same as: pgrep -f ".."
}

[[ $(daemon_running_p) -eq 0 ]] && emacs --daemon

emacsclient --quiet --no-wait --alternate-editor "" --create-frame "$@"
